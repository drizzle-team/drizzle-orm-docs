<div class="nav_search-wrap">
  <div class="search-wrap--centered" id="docsearch"></div>
</div>
<script type="module" is:inline data-astro-rerun>
  docsearch({
    container: '#docsearch',
    appId: "MXZNUT59HV",
    apiKey: "7c390e262ac8858df0b6624d01d9dfef",
    indexName: "orm-drizzle",
    placeholder: "Search documentation...",
  });

  // Initialize Inkeep Chat Button
  function initializeInkeep() {
    let themeName = localStorage.getItem('theme');
    if(themeName === 'system') {
      themeName = window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light';
    }

    const config = {
      baseSettings: {
        apiKey: '133604981aac855cac18d398251e01f28433cdf98918ad8d',
        integrationId: 'clpbm8p9y002ns601vbbswj5i',
        organizationId: 'clog94xy50001s601yapu7swn',
        organizationDisplayName: 'Drizzle ORM',
        primaryBrandColor: '#FFFFFF',
        theme: {
          colorMode: {
            forcedColorMode: themeName,
          },
        },
      },
      modalSettings: {
        areOpenHotKeysDisabled: true,
        defaultView: 'AI_CHAT',
      },
      aiChatSettings: {
        botAvatarSrcUrl: '/svg/drizzle.svg',
        exampleQuestions: ["How do I get started with Drizzle ORM?", "What databases does Drizzle support?", "How do I create a schema?"],
      },
    };

    // Initialize the chat button widget
    try {
      const widget = Inkeep.ChatButton(config);
      window.inkeepWidget = widget;
      console.log('Inkeep widget initialized successfully');
    } catch (error) {
      console.error('Failed to initialize Inkeep widget:', error);
    }
  }

  // Wait for both DOM and Inkeep script to be ready
  function waitForInkeep() {
    if (typeof Inkeep !== 'undefined') {
      initializeInkeep();
    } else {
      setTimeout(waitForInkeep, 100);
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', waitForInkeep);
  } else {
    waitForInkeep();
  }
</script>
<style>
  .nav_search-wrap {
    align-items: center;
    display: flex;
    flex-grow: 1;
    gap: 12px;
    max-width: 420px;
  }

  html[class~=dark] .nav_ai-btn {
    background-color: #1c1c1c;
  }

  .nav_ai-btn {
    width: 108px;
    height: 33px;
    background-color: #F4F4F4;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 500;
    color: #374151;
    transition: background-color 0.2s ease;
  }

  .nav_ai-btn:hover {
    background-color: #e5e7eb;
  }

  html[class~=dark] .nav_ai-btn:hover {
    background-color: #2d2d2d;
  }

  @media screen and (max-width: 768px) {
    .nav_search-wrap {
      display: none;
    }
    
  }
</style>