import {CodeTab, CodeTabs} from "../../components/CodeTabs/CodeTabs";
import Section from "../../components/Section/Section";
import { Tab, Tabs, Callout } from 'nextra-theme-docs';

# Configuration files
Drizzle Kit lets you declare configurations in `TypeScript`, `JavaScript` or `JSON` configuration files.  
You can have autocomplete experience and very convenient enviroment variables flow!  

```plaintext {5}
ðŸ“¦ <project root>
 â”œ ...
 â”œ ðŸ“‚ drizzle
 â”œ ðŸ“‚ src
 â”œ ðŸ“œ drizzle.config.ts
 â”” ðŸ“œ package.json
```

<CodeTabs items={["drizzle.config.ts", "drizzle.config.js", "drizzle.config.json"]}>
<CodeTab>
```ts
import type { Config } from "drizzle-kit";

export default {
  schema: "./src/schema.ts",
  out: "./drizzle",
} satisfies Config;
```
</CodeTab>
<CodeTab>
```js
import type { Config } from "drizzle-kit";

/** @type { import("drizzle-kit").Config } */
export default {
  schema: "./src/schema.ts",
  out: "./drizzle",
};
```
</CodeTab>
<CodeTab>
```json
{
  "schema": "./src/schema.ts",
  "out": "./drizzle",
}
```
</CodeTab>
</CodeTabs>

## Schema files paths
`schema` param lets you define where your schema file/files live.  
You can have as many separate schema files as you want and define paths to them using 
[`glob`](https://www.digitalocean.com/community/tools/glob?comments=true&glob=/**/*.js&matches=false&tests=//%20This%20will%20match%20as%20it%20ends%20with%20'.js'&tests=/hello/world.js&tests=//%20This%20won't%20match!&tests=/test/some/globs)
 or array of globs syntax.

<Tabs items={["Example 1", "Example 2", "Example 3"]}>
<Tab>
<Section>
```plaintext {7}
ðŸ“¦ <project root>
 â”œ ...
 â”œ ðŸ“‚ drizzle
 â”œ ðŸ“‚ src
 â”‚ â”œ ...
 â”‚ â”œ ðŸ“œ index.ts
 â”‚ â”” ðŸ“œ schema.ts 
 â”œ ðŸ“œ drizzle.config.ts
 â”” ðŸ“œ package.json
```
```ts
import type { Config } from "drizzle-kit";

export default {
  schema: "./src/schema.ts",
} satisfies Config;
```
</Section>
</Tab>
<Tab>
<Section>
```plaintext {7,10}
ðŸ“¦ <project root>
 â”œ ...
 â”œ ðŸ“‚ drizzle
 â”œ ðŸ“‚ src
 â”‚ â”œ ðŸ“‚ user
 â”‚ â”‚ â”œ ðŸ“œ handler.ts 
 â”‚ â”‚ â”” ðŸ“œ schema.ts 
 â”‚ â”œ ðŸ“‚ posts
 â”‚ â”‚ â”œ ðŸ“œ handler.ts 
 â”‚ â”‚ â”” ðŸ“œ schema.ts 
 â”‚ â”” ðŸ“œ index.ts
 â”œ ðŸ“œ drizzle.config.ts
 â”” ðŸ“œ package.json
```
```ts
import type { Config } from "drizzle-kit";

export default {
  schema: "./src/**/schema.ts",
  //or
  schema: ["./src/user/schema.ts", "./src/posts/schema.ts"]
} satisfies Config;
```
</Section>
</Tab>
<Tab>
<Section>
```plaintext {6-8}
ðŸ“¦ <project root>
 â”œ ...
 â”œ ðŸ“‚ drizzle
 â”œ ðŸ“‚ src
 â”‚ â”œ ðŸ“‚ schema
 â”‚ â”‚ â”œ ðŸ“œ user.ts 
 â”‚ â”‚ â”œ ðŸ“œ post.ts 
 â”‚ â”‚ â”” ðŸ“œ commnet.ts 
 â”‚ â”” ðŸ“œ index.ts
 â”œ ðŸ“œ drizzle.config.ts
 â”” ðŸ“œ package.json
```
```ts
import type { Config } from "drizzle-kit";

export default {
  schema: "./src/schema/*",
} satisfies Config;
```
</Section>
</Tab>
</Tabs>


## Migrations folder
`out` param lets you define folder for your migrations, it's optional and `drizzle` by default.  
It's very useful since you can have many separate schemas for different databases in the same project 
and have different migration folders for them.  
  
Migration folder contains `.sql` migration files and `_meta` folder which is used by `drizzle-kit`
<Callout type="warning" emoji="âš ï¸">
	Don't delete any files manually, please refer to [`drizzle-kit drop`](./commands/drop) command
</Callout>

<Section>
```plaintext {3}
ðŸ“¦ <project root>
 â”œ ...
 â”œ ðŸ“‚ drizzle
 â”‚ â”œ ðŸ“‚ _meta
 â”‚ â”œ ðŸ“œ user.ts 
 â”‚ â”œ ðŸ“œ post.ts 
 â”‚ â”” ðŸ“œ commnet.ts 
 â”œ ðŸ“‚ src
 â”œ ðŸ“œ drizzle.config.ts
 â”” ðŸ“œ package.json
```
```ts {5}
import type { Config } from "drizzle-kit";

export default {
  schema: "./src/schema/*",
  out: "./drizzle",
} satisfies Config;
```
</Section>

## SQL breakpoints
`breakpoints` param lets you enable/disable SQL statement breakpoints in generated migrations. It's optional and `true` by default, 
it's necessary to properly apply migrations on databases, that do not support multiple DDL alternation statements in one transaction(MySQL, SQLite) 
and Drizzle ORM has to apply them sequentially one by one.
```sql {5}
CREATE TABLE `book` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`name` text
);
--> statement-breakpoint
CREATE TABLE `book_to_author` (
	`author_id` integer,
	`book_id` integer,
	PRIMARY KEY(`book_id`, `author_id`)
);
```
## Push and Pull
Drizzle Kit provides you [introspect](./commands#introspect--pull) and [push](./commands#prototype--push) APIs.  
We mirror connection params of database drivers

<Tabs items={["Connection URI", "Connection params"]}>
<Tab>
```ts {6}
import type { Config } from "drizzle-kit";
import * as dotenv from "dotenv";
dotenv.config();

export default {
  schema: "./src/schema/*",
  out: "./drizzle",
  connectionString: process.env.DATABASE_URL,
} satisfies Config;
```
</Tab>
<Tab>
```ts {6-10}
import type { Config } from "drizzle-kit";
import * as dotenv from "dotenv";
dotenv.config();

export default {
  schema: "./src/schema/*",
  out: "./drizzle",
  user: "postgres",
  password: process.env.DATABASE_PASSWORD,
  host: "127.0.0.1",
  port: 5432,
  db: "db",
} satisfies Config;
```
</Tab>
</Tabs>

## Multi-project schema
`tablesFilter` param lets you filter tables with [`glob`](https://www.digitalocean.com/community/tools/glob?comments=true&glob=/**/*.js&matches=false&tests=//%20This%20will%20match%20as%20it%20ends%20with%20'.js'&tests=/hello/world.js&tests=//%20This%20won't%20match!&tests=/test/some/globs) 
syntax for db [`push`](./commands#prototype--push) command.  
It's useful when you have only one database avaialable for several separate projects with separate sql schemas.  
How to define multi-project tables with Drizzle ORM - [see here](/docs/goodies#multi-project-schema)

<Section>
```ts {3}
import { serial, text, pgTableCreator } from 'drizzle-orm/pg-core';

const pgTable = pgTableCreator((name) => `project1_${name}`);

const users = pgTable('users', {
  id: serial('id').primaryKey(),
  name: text('name').notNull(),
});
```
```ts {7}
import type { Config } from "drizzle-kit";
import * as dotenv from "dotenv";
dotenv.config();

export default {
  schema: "./src/schema/*",
  out: "./drizzle",
  connectionString: process.env.DATABASE_URL,
  tablesFilter: ["project1_*"],
} satisfies Config;
```
</Section>

You can apply multiple `or` filters
```ts
tablesFilter: ["project1_*", "project2_*"]
```
